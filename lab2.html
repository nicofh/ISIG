<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no">
        <link rel="stylesheet" href="https://js.arcgis.com/4.5/esri/css/main.css">
        <link rel="stylesheet" href="css/styles.css">
        <link rel="stylesheet" href="css/bootstrap.css">


        <title>Obligatorio2-ISIG2017</title>


        <script>
            var dojoConfig = {
              packages: [{
                name: "geolocate",
                location: "//2gis.github.io/mock-geolocation/dist",
                main: "geolocate"
              }]
            }
          </script>
                  <script src="https://js.arcgis.com/4.5/"></script>


        <script >
          var numParada=0;
           require([
          "esri/Map",
          "esri/views/MapView",
          "dojo/dom",
           "dojo/on",
           "esri/layers/TileLayer",

           "esri/symbols/PictureMarkerSymbol",
           "esri/renderers/SimpleRenderer",
           "esri/layers/GraphicsLayer",
           "esri/Graphic",
           "esri/geometry/support/webMercatorUtils",
           "esri/tasks/Locator",
           "esri/widgets/Search",
           "esri/tasks/RouteTask",
           "esri/tasks/support/RouteParameters",
           "esri/tasks/support/FeatureSet",
           "esri/core/urlUtils",
           "esri/symbols/SimpleLineSymbol",
           "esri/Color",
           "esri/layers/FeatureLayer",
           "esri/tasks/QueryTask",
           "esri/tasks/support/Query",
           "esri/widgets/Track",
           "geolocate",
           "esri/symbols/PictureMarkerSymbol",
           "esri/tasks/GeometryService",
           "esri/tasks/support/BufferParameters",
           "esri/widgets/Print",
           "esri/symbols/SimpleFillSymbol",
            "esri/geometry/Point",
			"esri/symbols/TextSymbol",

           "dojo/domReady!"




        ], function(Map,MapView,dom,on,TileLayer,PictureMarkerSymbol,SimpleRenderer,GraphicsLayer,Graphic,webMercatorUtils,Locator,Search,RouteTask,
            RouteParameters,FeatureSet,urlUtils,SimpleLineSymbol,Color,FeatureLayer,QueryTask,Query,Track,geolocate,PictureMarkerSymbol,GeometryService,
            BufferParameters,Print,SimpleFillSymbol,Point,TextSymbol) {



          urlUtils.addProxyRule({
              urlPrefix: "route.arcgis.com",
              proxyUrl: "http://localhost:8080/proxy/proxy.jsp"
            });

          var map = new Map({
            basemap: "streets",


          });

          var view = new MapView({
            container: "viewDiv",  // Reference to the DOM node that will contain the view
            map: map,               // References the map object created in step 3
            center: [-94.4035, 39.802],
            zoom: 4
          });



          //buttons
          on(dom.byId("generarRuta"), "click", generarRuta);
          on(dom.byId("guardarRuta"), "click", guardarRuta);
          on(dom.byId("limpiarTodo"), "click", limpiarTodo);
          on(dom.byId("selRutas"), "change", cargarRutaExistente);
          on(dom.byId("simularMovil"),"click",iniciarSimulacion);
          on(dom.byId("modificarVelocidad"),"click",modificarVelocidad);
          on(dom.byId("exportpdf"),"click",exportpdf);


          var layer = new TileLayer("http://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer");
          map.layers.add(layer);

          view.then( function(event){
            //view.on('click',addStop);
          });
          view.on('click',addStop);

          //variables
          var tablaParadas = [];

          //SIMBOLOS
          var stopSymbol = new PictureMarkerSymbol('http://static.arcgis.com/images/Symbols/Basic/LightBlueShinyPin.png',51,51);

          //Simbolo de Condado
           var condadoSymbol = new SimpleFillSymbol(

            );

           condadoSymbol.type= "simple-fill";
           condadoSymbol.color=[ 51,51, 204, 0.9 ];
          condadoSymbol.outline={  // autocasts as new SimpleLineSymbol()
                  color: "white",
                  width: 1
                };

           //Servicio de Condados
            var servicioCondados = new QueryTask("http://services.arcgisonline.com/arcgis/rest/services/Demographics/USA_1990-2000_Population_Change/MapServer/3");

          //CAPAS
            //Capa de paradas
            var capaParadas = new GraphicsLayer();
            //var paradaRender = SimpleRenderer(stopSymbol);
            //capaParadas.setRenderer(paradaRender);
            map.layers.add(capaParadas);

            //Capa de Eventos
            var capaEventos = new FeatureLayer("http://sampleserver5.arcgisonline.com/arcgis/rest/services/LocalGovernment/Events/FeatureServer/0",{
            mode: FeatureLayer.MODE_ONDEMAND,
            outFields: ["*"],
            opacity:0.9
            });
            capaEventos.spatialReference=map.spatialReference;

            //Capa de Condados
            var capaCondados = new GraphicsLayer();
            capaCondados.opacity = 0.5;
            map.layers.add(capaCondados);

			//Capa Buffer
			var capaBuffer = new GraphicsLayer();
            map.layers.add(capaBuffer);

			//Capa Labels
			var capaLabels = new GraphicsLayer();
            map.layers.add(capaLabels);






          //STOPS

          //traduce nombre a coordenadas
           var locator = new Locator("http://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer");

          var locationPoint;
          function addStop(evt) {
            locationPoint = new Graphic(evt.mapPoint, stopSymbol);
            capaParadas.graphics.add(locationPoint)
                        console.log("MAPPOINT",webMercatorUtils.webMercatorToGeographic(evt.mapPoint))

            var result = locator.locationToAddress(webMercatorUtils.webMercatorToGeographic(evt.mapPoint));
            result.then(function(addressCandidate){
                console.log(addressCandidate.address, addressCandidate.location.latitude, addressCandidate.location.longitude)
                tablaParadas.push({"address" :addressCandidate.address,"latitude":addressCandidate.location.latitude, "longitude":addressCandidate.location.longitude}) ;

                console.log("tabla",tablaParadas)
                var list = document.getElementById('rutaList');
                var nuevoItem = document.createElement('li');
                nuevoItem.setAttribute('draggable','true');
                nuevoItem.ondblclick = function() {sacarParada(this);}
                nuevoItem.appendChild(document.createTextNode( '-      '+addressCandidate.address));
                list.appendChild(nuevoItem);
                $("#rutaList").sortable('refresh');
            })

          }

          function sacarParada(parada){
            var lugarRemovido = parada.innerHTML;
            for(var j=0; j< tablaParadas.length; j++){
              var elem=lugarRemovido.replace('-      ','');
              if (elem === tablaParadas[j].address){
                console.log("true",capaParadas.graphics.items[j])
                capaParadas.graphics.remove(capaParadas.graphics.items[j])
                tablaParadas.splice(j,1);
                numParada--;
              }
            }
            console.log(tablaParadas)
            parada.parentNode.removeChild(parada);
          }







          // RUTAS

          //Rutas Layer

          //Capa de Rutas
          var capaRutas = new GraphicsLayer();
            //var paradaRender = SimpleRenderer(stopSymbol);
            //capaParadas.setRenderer(paradaRender);
            map.layers.add(capaRutas);

          //ruta layer service
          var rutaLayerService = new FeatureLayer("http://sampleserver5.arcgisonline.com/arcgis/rest/services/LocalGovernment/Recreation/FeatureServer/1",{
            mode: FeatureLayer.MODE_ONDEMAND,
            outFields: ["*"]
          });
          rutaLayerService.spatialReference = map.spatialReference;

          var rutaActual;
          var routeSymbol = new SimpleLineSymbol();

          var routeTask = new RouteTask("http://route.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World/");
          var routeParams = new RouteParameters();
              routeParams.stops = new FeatureSet();
              routeParams.outSpatialReference = {"wkid":102100};
          var salto=1;
          var exportar= 0;



          function guardarRuta(){
            console.log(rutaActual)

            //AGREGAR EVENTOS
           var stops = document.getElementById('rutaList').getElementsByTagName('li');
            var lugar;
            console.log(stops)
            for (var i=0; i < stops.length; i++){
              lugar = stops[i].innerHTML;
              console.log(lugar)
              for(var j=0; j< tablaParadas.length; j++){
                console.log()
                if (lugar.replace('-      ','') == tablaParadas[j].address){
                   var evento = new Graphic(capaParadas.graphics.items[j].geometry, null,null);
                   var nombreRuta = $('#routeName').val();
                   evento.setAttribute("event_type",3);
                   evento.setAttribute("description", nombreRuta);
                   capaEventos.applyEdits({addFeatures:[evento]});
                }
              }
            }


            var rutaGuardada = new Graphic(rutaActual.items[0].geometry, null,null);
            var nombreRuta = $('#routeName').val();
            rutaGuardada.setAttribute("trailtype",2);
            rutaGuardada.setAttribute("condition",2);
            rutaGuardada.setAttribute("difficulty",1);
            rutaGuardada.setAttribute("segregation",0);

            rutaGuardada.setAttribute("notes", nombreRuta)
            var date =new Date("July 19, 1950 11:13:00");
            rutaGuardada.setAttribute("recordedon",19061950)
            rutaLayerService.applyEdits({addFeatures:[rutaGuardada]}).then(function(data){
              console.log(data);
              cargarRutas();
            });



          }

          function generarRuta(){ //resuelve la ruta
            capaRutas.graphics.removeAll();


            if(routeParams.stops.features.length>0){
              routeParams.stops.features=[];
            }
            //tener en cuenta q cuando genera ruta tiene que seguir el orden de la rutalist del html, ya que ahi esta el orden
            //en que se quiere obtener los puntos de la ruta.
            var stops = document.getElementById('rutaList').getElementsByTagName('li');
            var lugar;
            for (var i=0; i < stops.length; i++){
              lugar = stops[i].innerHTML;
              for(var j=0; j< tablaParadas.length; j++){
                if (lugar.replace('-      ','') == tablaParadas[j].address){
                  console.log(capaParadas.graphics.items[j].geometry)
                  var point = new Point( tablaParadas[j].longitude,tablaParadas[j].latitude);
                  var graphic= new Graphic(point,stopSymbol);
                  console.log("POINT",point);
                  routeParams.stops.features.push(graphic);
                }
              }
            }
            console.log("routeParams",routeParams.stops.features);

            if(routeParams.stops.features.length>=2){

              routeTask.solve(routeParams).then(mostrarRuta,function(err){console.log(err)})

            }
          }
          var pathRuta=[];
          function mostrarRuta(data){
            console.log(data)
              var routeResult = data.routeResults[0].route;
              routeResult.symbol = routeSymbol;
              rutaActual= capaRutas.graphics.add(routeResult);

              pathRuta= routeResult.geometry;

              //console.log(routeResult.geometry.getPoint(0,0))
              //console.log(routeResult.geometry.getPoint(0,))

          }

          function iniciarSimulacion(){
            console.log(pathRuta)
            modificarVelocidad()
            capaCondados.graphics.removeAll();



            var coords=[];
            //var path= pathRuta.getPoint()
            for(var i=0; i<pathRuta.paths[0].length;i=i+1){
              var elem=pathRuta.getPoint(0,i);
              coords.push({lat: elem.latitude,lng: elem.longitude})
            }
            //coords.push({lat:pathRuta.getPoint(0,pathRuta.paths[0].length-1).latitude, lng:pathRuta.getPoint(0,pathRuta.paths[0].length-1).longitude});
            console.log(coords)

            stubGeolocation(coords);



          }

          function modificarVelocidad(){
            var velocidad=document.getElementById('velocidad').value;
            salto= Math.floor((pathRuta.paths[0].length) /(1000/velocidad));
            if(velocidad<=33){
              track.graphic.symbol= movilSymbolGreen;
            }
            else if( velocidad>=66){
               track.graphic.symbol= movilSymbolRed;

            }
            else{
              track.graphic.symbol= movilSymbolYellow;
            }
          }


          function limpiarTodo(){
            for (var i=routeParams.stops.features.length-1; i>=0; i--) {
              capaParadas.graphics.remove(routeParams.stops.features.splice(i, 1)[0]);
            }
            tablaParadas = [];
            capaParadas.graphics.removeAll();
            capaRutas.graphics.removeAll();
            capaCondados.removeAll();
            capaBuffer.removeAll();
			capaLabels.removeAll();
            track.stop();

            $('#rutaList').empty();
            $("#rutaList").sortable('refresh');

            // borro los intervals corriendo
            for (var i=intervals.length - 1; i>=0 ; i--) {
              clearInterval(intervals[i]);
            }

          }


          function cargarRutas(){
            $('#selRutas').empty()
            var queryTask = new QueryTask("http://sampleserver5.arcgisonline.com/arcgis/rest/services/LocalGovernment/Recreation/FeatureServer/1");
            query = new Query();
            query.outFields = ["*"];
            var date=new Date("July 19, 1950 11:13:00");
            query.where = "trailtype = "+ 2 + " AND condition = " + 2 + "AND difficulty = " + 1+"AND segregation = " + 0;
            query.returnGeometry = false;
            queryTask.execute(query).then(function(res){
                                        console.log(res)
                                        var select = document.getElementById("selRutas");
                                        for ( i=0 ;i < res.features.length; i++){
                                          var option = document.createElement('option');
                                          option.text = option.value = res.features[i].attributes.notes;
                                          select.add(option, 0);
                                        }
                                       })

          }

          function cargarRutaExistente(){

          capaRutas.graphics.removeAll();
          capaParadas.graphics.removeAll();
          tablaParadas=[];
          $("#rutaList").empty();

          var r = $( "#selRutas option:selected" ).text();
          var queryTask = new QueryTask("http://sampleserver5.arcgisonline.com/arcgis/rest/services/LocalGovernment/Recreation/FeatureServer/1");
          query = new Query();
          query.outFields = ["*"];
          query.where = "notes = '"+ r +"'";
          query.returnGeometry = true;
          query.outSpatialReference = map.spatialReference;
          queryTask.execute(query).then(function(res){

            var ruta = new Graphic(res.features[0].geometry, routeSymbol);
            console.log(ruta)
            capaRutas.graphics.add(ruta);
            pathRuta= ruta.geometry;
            document.getElementById("routeName").value = r;



            //traerse puntos de la ruta
              var queryTask = new QueryTask("http://sampleserver5.arcgisonline.com/arcgis/rest/services/LocalGovernment/Events/FeatureServer/0");
              query = new Query();
              query.outFields = ["*"];
              query.where = "description = '"+ r +"'";
              query.returnGeometry = true;
              query.outSpatialReference = map.spatialReference;
              queryTask.execute(query).then(function(res){
                    for(var i=0;i<res.features.length;i++){
                      var stop = new Graphic(res.features[i].geometry, stopSymbol);
                      capaParadas.graphics.add(stop);
                        console.log("CARGAR RUTA",res.features[i].geometry)
                       var result = locator.locationToAddress((res.features[i].geometry));
                       result.then(function(addressCandidate){
                            tablaParadas.push({"address" :addressCandidate.address,"latitude":addressCandidate.location.latitude, "longitude":addressCandidate.location.longitude}) ;

                            console.log("tabla",tablaParadas)
                            var list = document.getElementById('rutaList');
                            var nuevoItem = document.createElement('li');
                            nuevoItem.setAttribute('draggable','true');
                            nuevoItem.ondblclick = function() {sacarParada(this);}
                            nuevoItem.appendChild(document.createTextNode( '-      '+addressCandidate.address));
                            list.appendChild(nuevoItem);
                            $("#rutaList").sortable('refresh');


                        });
                     }
              });
          })
         }


          $(function() {
                cargarRutas();
                        geolocate.use();

            });









          // SEARCH
          var searchWidget = new Search({
            view: view
          });
          // Adds the search widget below other elements in
          // the top left corner of the view
          view.ui.add(searchWidget, {
            position: "top-right",
            index: 2
          });


          var sources = [
            {
              locator: new Locator({ url: "//geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer" }),
              singleLineFieldName: "SingleLine",
              outFields: ["Addr_type"],
              localSearchOptions: {
                minScale: 300000,
                distance: 50000
              },
              resultSymbol: {
                     type: "picture-marker",  // autocasts as new PictureMarkerSymbol()

                     size: 0,
                     width: 0,
                     height: 0,
                     xoffset: 0,
                     yoffset: 0
                 }
                          }
          ];

          searchWidget.sources = sources;



          searchWidget.on("search-complete", function(event){
            // The results are stored in the event Object[]

            var coordenadas = event.results[0].results[0].feature.geometry;
            locationPoint = new Graphic(coordenadas, stopSymbol);
            capaParadas.graphics.add(locationPoint);
            tablaParadas.push({"address" :event.searchTerm,"latitude":coordenadas.latitude, "longitude":coordenadas.longitude}) ;
            var list = document.getElementById('rutaList');
            var nuevoItem = document.createElement('li');
            nuevoItem.setAttribute('draggable','true');
            nuevoItem.ondblclick = function() {sacarParada(this);}
            nuevoItem.appendChild(document.createTextNode( '-      '+event.searchTerm));
            list.appendChild(nuevoItem);
            $("#rutaList").sortable('refresh');
          });



          //SIMULACION
          var movilSymbolRed = new PictureMarkerSymbol('http://static.arcgis.com/images/Symbols/Transportation/CarRedFront.png', 51, 51);
          var movilSymbolGreen = new PictureMarkerSymbol('http://static.arcgis.com/images/Symbols/Transportation/CarGreenFront.png', 51, 51);
          var movilSymbolYellow = new PictureMarkerSymbol('http://static.arcgis.com/images/Symbols/Transportation/CarYellowFront.png', 51, 51);

          var track = new Track({
              view: view,  // Assigns the track widget to a view
              goToLocationEnabled: false,
              graphic: new Graphic({
                  // Overwrites the default symbol used for the
                  // graphic placed at the location of the user when found
                })
            });

          view.ui.add(track, {
            position: "bottom-right",
            index: 2
          });

          view.then(function() {
                var prevLocation = view.center;
                var startLocation= track.graphic.geometry;
                console.log("startLocation",startLocation);
                track.on("track", function() {
                  var location = track.graphic.geometry;



                  prevLocation = location.clone();
                });

      });

      function getHeading(point, oldPoint) {
        // get angle between two points
        var angleInDegrees = Math.atan2(point.y - oldPoint.y, point.x -
            oldPoint.x) * 180 /
          Math.PI;

        // move heading north
        return -90 + angleInDegrees;
      }


      var intervals = [];

      // geolocation simulator

      function stubGeolocation(coords) {


          console.log(coords)
          currentCoordIndex = 0;

        var startcoord= coords[0];
        var id =setInterval(function() {
          capaBuffer.graphics.removeAll();
		  capaLabels.graphics.removeAll();
          capaCondados.graphics.removeAll();
          capaCondados.removeAll()
          geolocate.change(coords[currentCoordIndex]);
          buffer();
          currentCoordIndex = (currentCoordIndex + salto) ;

          if(currentCoordIndex==coords.length-1){

            track.stop();
            clearInterval(id);

            clearBuffer()
            clearCondados();
			clearLabels();
          }
          else if(currentCoordIndex>coords.length-1){
            currentCoordIndex= coords.length-1;
            salto=0;
          }

        }, 4500);

        intervals.push(id);

        track.start()

        };

        function clearBuffer(){
          setInterval(function() {
                   capaBuffer.graphics.removeAll();


        }, 1500);

        }

        function clearCondados(){
          setInterval(function() {
                   capaCondados.graphics.removeAll();


        }, 1500);

        }
		function clearLabels(){
          setInterval(function() {
                   capaLabels.graphics.removeAll();


        }, 1500);

        }




        //BUFFER
        var geometryService = new GeometryService("http://sampleserver6.arcgisonline.com/arcgis/rest/services/Utilities/Geometry/GeometryServer");
        var bufferParam = new BufferParameters();
        var polySym = {
          type: "simple-fill", // autocasts as new SimpleFillSymbol()
          color: [140, 140, 222, 0.5],
          outline: {
            color: [0, 0, 0, 0.5],
            width: 2
          }
        };

		var radio;

        function buffer() {
          radio=document.getElementById('radio').value;
          bufferParam.distances = [radio];
          bufferParam.unit = "miles";
          bufferParam.geodesic = true;
          bufferParam.geometries = [pathRuta.getPoint(0,currentCoordIndex)];
          geometryService.buffer(bufferParam).then(function(results){
            capaBuffer.graphics.removeAll();
            bufferGrafico=new Graphic({
               geometry: results[0],
               symbol: polySym
            });
            capaBuffer.add(bufferGrafico);
            obtenerCondados();

          });

        }




      //print map

        var print;
        function exportpdf(){

          if(exportar==0){

            print = new Print({
                view: view,
                printServiceUrl: 'http://sampleserver5.arcgisonline.com/arcgis/rest/services/Utilities/PrintingTools/GPServer/Export%20Web%20Map%20Task'
              });
              // Adds widget below other elements in the top left corner of the view
              view.ui.add(print, {
                position: "bottom-left"

              });
              exportar=1;
          }
          else{
            exportar=0;
            print.destroy()
          }
        }



        //interseccion con condados
          var bufferGrafico;
          function obtenerCondados(){
            var query = new Query();
            query.outFields = ["OBJECTID","TOTPOP_CY","NAME","LANDAREA"];
            query.geometry =  bufferGrafico.geometry;
            query.returnGeometry = true;
			query.spatialRelationship = "intersects";
            servicioCondados.execute(query).then(obtenerInterseccionCondados)
          }


          function obtenerInterseccionCondados(res){
            console.log("Res",res)
			var areaBuffer= radio*radio* 3.14;
			var totalBufferPop=0;
			var overlappedCountiePop=0;
            for (var i = 0;  i < res.features.length; i++) {
              var condado = Graphic(res.features[i].geometry, condadoSymbol);
              capaCondados.graphics.add(condado);
			  console.log("atributos");
			  console.log(res.features[i].attributes);
			  console.log("Population");
			  var pop= res.features[i].attributes.TOTPOP_CY;
			  console.log(pop);
			  overlappedCountiePop= pop*(areaBuffer/(res.features[i].attributes.LANDAREA));
			  totalBufferPop= totalBufferPop+overlappedCountiePop;
            }
			var textSymbol = {
				type: "text",  // autocasts as new TextSymbol()
				color: "red",
				borderLineColor: "black",
				haloColor: "gray",
				haloSize: "1px",
				text: "Buffer Population: "+Math.floor(totalBufferPop),
				xoffset: 3,
				yoffset: 3,
				font: {  // autocast as new Font()
					size: 12,
					family: "sans-serif",
					weight: "bolder"
				}
			};
			var label = new Graphic({
				geometry:   bufferGrafico.geometry.getPoint(0,0),
				symbol: textSymbol,
			 });
			capaLabels.graphics.add(label);



          }

          function errorHandler(err) {
            alert("An error occured\n" + err.message + "\n" + err.details.join("\n"));
          }

      })













        </script>

    </head>

    <body>

          <div class="row">

            <!--Barra lateral-->
            <div class="col-md-3 ">

                <ul class="nav nav-pills" style="background-color:#d4d4d4">
                  <li class="active" style="padding-left:10px"><a data-toggle="pill" href="#home">Inicio</a></li>

                </ul>

                 <div class="tab-content" style="margin-left:20px">
                    <!--Menu Home-->
                    <div id="home" class="tab-pane fade in active" >
                       <input id="routeName"  style="width: 250px;background-color:transparent;
                                                      border-color:transparent; font-size:20px; margin-top:20px;
                                                      margin-left:10px"
                              placeholder="Nombre Ruta..."


                        ></input>

                       <ul id="rutaList"  class="sortable list li-sort"  style="margin-left:10px; width:80%; padding:0px" >
                       </ul>

                       <button  id="generarRuta" class="btn btn-primary bttons" style="margin-left:10px">Generar Ruta</button>
                       <button  id="guardarRuta" class="btn btn-primary bttons" style="margin-left:10px">Guardar Ruta</button>

                      <br>
                      <br>
                      <div style="margin-left:10px">
                       <h4> Seleccionar Ruta</h4>
                       <select id="selRutas" name="selectRutas" style="width: 80%; border-radius:8px; background-color:rgba(243, 243, 243, 0.93) !important" ></select>
                      </div>

                      <div style="margin-top:30px">
                          <button  id="limpiarTodo" class="btn btn-primary bttons" style="margin-left:10px">Limpiar Todo</button>

                       </div>


                       <div>
                           <div style="margin-left:10px; margin-top:10px">
                           <hr style="background-color: dimgrey !important;
                                        color: dimgrey !important;
                                        border: solid 0.4px dimgrey !important;margin-right:20px" />
                           <h3> Simulacion</h3></div>
                           <div style="margin-left:10px; margin-top:7px; " > <h5 style="display:inline-block">Velocidad:</h5>
                                 <input id="velocidad"  style="width: 50px;background-color:transparent;
                                                      border-color:white; font-size:15px; display:inline-block"
                              value="10"


                        ></input><h5 style="display:inline-block" > %</h5>
                           </div>

                          <div style="margin-left:10px; margin-top:7px; " > <h5 style="display:inline-block">Radio Buffer:</h5>
                                 <input id="radio"  style="width: 50px;background-color:transparent;
                                                      border-color:white; font-size:15px; display:inline-block"
                              value="10"


                        ></input><h5 style="display:inline-block" > km</h5>
                           </div>

                           <button  id="simularMovil" class="btn btn-primary bttons" style="margin-left:10px;margin-top:30px"> Comenzar simulacion</button>
                           <button  id="modificarVelocidad" class="btn btn-primary bttons" style="margin-left:10px;margin-top:30px"> Modificar simulacion</button>

                        </div>

                        <div>
                          <hr style="background-color: dimgrey !important;
                                        color: dimgrey !important;
                                        border: solid 0.4px dimgrey !important;margin-right:20px" />
                            <button  id="exportpdf" class="btn btn-primary bttons" style="margin-left:10px;margin-top:5px"> Exportar Mapa</button>
                        </div>
                    </div>
                  </div>


            </div>

            <!--Seccion del mapa-->
            <div class="col-md-9" style="background-color:#e7eff1 !important">
              <!-- <input id="routeName" style="border-radius: 10px;float:right;margin-right: 20px;border-width: 1px;margin-top: 5px;margin-bottom: 5px ; height:5% "  placeholder="Write location..."> </input> -->

              <!--map div-->
              <div id="viewDiv"  ></div>
            </div>
            <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
            <script src="js/jquery.sortable.js"></script>




          </body>



    </body>
</html>